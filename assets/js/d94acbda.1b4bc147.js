"use strict";(self.webpackChunkskip_docs=self.webpackChunkskip_docs||[]).push([[7021],{55811:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>d,contentTitle:()=>l,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>i});const s=JSON.parse('{"id":"gcp/kostnadsoversikt-og-alarmer","title":"Kostnadsoversikt og alarmer","description":"Kostnadsoversikt","source":"@site/docs/05-gcp/04-kostnadsoversikt-og-alarmer.md","sourceDirName":"05-gcp","slug":"/gcp/kostnadsoversikt-og-alarmer","permalink":"/docs/gcp/kostnadsoversikt-og-alarmer","draft":false,"unlisted":false,"editUrl":"https://github.com/kartverket/skip-docs/edit/main/docs/05-gcp/04-kostnadsoversikt-og-alarmer.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Oppsett og bruk av Google Secret Manager","permalink":"/docs/gcp/oppsett-og-bruk-av-secret-manager"},"next":{"title":"\u2699\ufe0f Kubernetes","permalink":"/docs/kubernetes/"}}');var n=t(74848),a=t(28453);const o={},l="Kostnadsoversikt og alarmer",d={},i=[{value:"Kostnadsoversikt",id:"kostnadsoversikt",level:2},{value:"Alarmer",id:"alarmer",level:2},{value:"Hvordan sette opp et budsjett",id:"hvordan-sette-opp-et-budsjett",level:3},{value:"Slack",id:"slack",level:3}];function c(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"kostnadsoversikt-og-alarmer",children:"Kostnadsoversikt og alarmer"})}),"\n",(0,n.jsx)(r.h2,{id:"kostnadsoversikt",children:"Kostnadsoversikt"}),"\n",(0,n.jsx)(r.p,{children:"SKIP har laget et Grafana dashboard som kan brukes til \xe5 holde en l\xf8pende oversikt over kostnader.\nDashboardet viser kostnader fordelt p\xe5 prosjekter og tjenester, og gir en oversikt gruppert p\xe5 divisjoner eller teams."}),"\n",(0,n.jsxs)(r.p,{children:["Dashboardet kan man finne ",(0,n.jsx)(r.a,{href:"https://monitoring.kartverket.cloud/d/ee3q31rt3uosgd/gcp-cost?orgId=1&from=now-7d&to=now&timezone=browser&var-division=eiendom&var-team=$__all",children:"her"}),"."]}),"\n",(0,n.jsx)(r.h2,{id:"alarmer",children:"Alarmer"}),"\n",(0,n.jsx)(r.p,{children:"For \xe5 unng\xe5 overraskelser i form av h\xf8ye kostnader, er det viktig \xe5 sette opp alarmer. Alarmer kan settes opp for \xe5 varsle om kostnader som overstiger en viss grense, eller for \xe5 varsle om kostnader som \xf8ker raskt."}),"\n",(0,n.jsxs)(r.p,{children:["Vi anbefaler p\xe5 det sterkeste at alarmer blir satt n\xe5r dere tar i bruk tjenester i Google Cloud.\nDette kan gj\xf8res i ",(0,n.jsx)(r.a,{href:"https://github.com/kartverket/cost-alerts",children:"cost-alerts"})," repoet p\xe5 Github."]}),"\n",(0,n.jsx)(r.p,{children:"Kostnadsalarmer i GCP heter 'budgets', s\xe5 herfra referes kostnadsalarmer som budsjett."}),"\n",(0,n.jsx)(r.h3,{id:"hvordan-sette-opp-et-budsjett",children:"Hvordan sette opp et budsjett"}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.a,{href:"https://github.com/kartverket/cost-alerts",children:"cost-alerts"})," fungerer p\xe5 mange m\xe5ter likt som ",(0,n.jsx)(r.a,{href:"https://github.com/kartverket/grafana-alerts",children:"grafana-alerts"})," repoet.\nDersom dere skal opprette deres f\xf8rste budsjett, s\xe5 opprett en PR mot cost-alerts repoet hvor dere gj\xf8r f\xf8lgende:"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Opprett en fil med navnet p\xe5 teamet i ",(0,n.jsx)(r.code,{children:"teams"})," mappen, f.eks ",(0,n.jsx)(r.code,{children:"teams/mitt-team.tf"})]}),"\n",(0,n.jsxs)(r.li,{children:["Legg til en linje i ",(0,n.jsx)(r.code,{children:"CODEOWNERS"}),"-filen, med f\xf8lgende format: ",(0,n.jsx)(r.code,{children:"teams/mitt-team.tf @kartverket/mitt-team"})]}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:["I ",(0,n.jsx)(r.code,{children:"teams/mitt-team.tf"}),"-filen s\xe5 kan man opprette et budsjett slik:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-hcl",children:'module "mitt_team_gcp_budget" {\n  source = "./modules/gcp-budget"\n  budgets = [\n    {\n      name          = "produkt"\n      project_ids   = ["project-dev-1", "project-prod-2"]\n      budget_amount = 500                      \n      alert_exceeded_threshold = [0.75, 1.0] \n      alert_forecast_threshold = [1.0]         \n    }\n  ]\n  slack_channel_name           = "#your-teams-slack-channel"\n  email_address                = "alerts@example.com"\n}\n'})}),"\n",(0,n.jsx)(r.p,{children:"Forklaringer p\xe5 variabler:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"name"}),": Navnet p\xe5 budsjettet, dere velger selv"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"project_ids"}),": Prosjektene som budsjettet skal gjelde for. En prosjekt ID finner dere p\xe5 'forsiden' til prosjektet p\xe5 ",(0,n.jsx)(r.a,{href:"https://console.cloud.google.com",children:"GCP"}),"."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"budget_amount"}),": Bel\xf8pet som budsjettet skal varsle om. Dette er i EURO."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"alert_exceeded_threshold"}),": Dette er en liste med tall som sier hvor mye av budsjettet som skal overskrides f\xf8r det varsles. Tallene er i desimalformat av prosent, alts\xe5 0.75 = 75%. Valgfritt, standard er 0.75 og 1.0."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"alert_forecast_threshold"}),": Samme som over, men her varsles det om forventet bruk. Valgfritt, standard er 1.0."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"slack_channel_name"}),": Navnet p\xe5 slack-kanalen som varsler skal sendes til, husk \xe5 inkluder # foran navnet."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"email_address"}),": E-postadressen som varsler skal sendes til."]}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"README i cost-alerts repoet inneholder mer utfyllende informasjon om bruk av modulen."}),"\n",(0,n.jsx)(r.h3,{id:"slack",children:"Slack"}),"\n",(0,n.jsxs)(r.p,{children:["Dersom dere har lagt inn at det skal varsles til slack, s\xe5 m\xe5 dere invitere ",(0,n.jsx)(r.code,{children:"SKIP Slack Bot"})," til kanalen det skal varsles til."]})]})}function m(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},28453:(e,r,t)=>{t.d(r,{R:()=>o,x:()=>l});var s=t(96540);const n={},a=s.createContext(n);function o(e){const r=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(a.Provider,{value:r},e.children)}}}]);