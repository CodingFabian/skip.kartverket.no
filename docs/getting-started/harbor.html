<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="SKIP Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="SKIP Blog Atom Feed"><title data-react-helmet="true">Oppsett og bruk av Harbor | SKIP</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://kartverket.github.io/docs/getting-started/harbor"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Oppsett og bruk av Harbor | SKIP"><meta data-react-helmet="true" name="description" content="For å kunne publisere docker-images til registry i Harbor, må man ha opprettet"><meta data-react-helmet="true" property="og:description" content="For å kunne publisere docker-images til registry i Harbor, må man ha opprettet"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://kartverket.github.io/docs/getting-started/harbor"><link data-react-helmet="true" rel="alternate" href="https://kartverket.github.io/docs/getting-started/harbor" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://kartverket.github.io/docs/getting-started/harbor" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.c1af1c4a.css">
<link rel="preload" href="/assets/js/runtime~main.7f1dd57f.js" as="script">
<link rel="preload" href="/assets/js/main.3de5be80.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/skip.png" alt="SKIP" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/skip.png" alt="SKIP" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">SKIP</b></a><a href="https://kartverket.atlassian.net/wiki/spaces/SKIPDOK" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://kartverket.atlassian.net/jira/software/projects/SKIP/boards/2/roadmap" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Roadmap<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://kartverket.atlassian.net/wiki/spaces/SKIPDOK/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Nyhetsbrev<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://kartverket.atlassian.net/wiki/spaces/SKIP" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Confluence<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/orgs/kartverket/teams/skip" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/intro">Introduksjon</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Kom i gang!</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/deploy-to-kubernetes">Deploye til Kubernetes</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/gitlab-builds">GitLab-byggeløyper</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/basic-botkube-commands">Grunnleggende BotKube-kommandoer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/groups-and-projects-in-gitlab">Grupper og prosjekter i GitLab</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/kubernetes-manifests">Kubernetes manifestfiler</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/login-and-access-to-cluster">Login og tilgang til cluster miljøer</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/getting-started/harbor">Oppsett og bruk av Harbor</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/vault">Oppsett og bruk av Vault</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/helm">Bruk av Helm</a></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/roadmap">Roadmap</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Oppsett og bruk av Harbor</h1></header><p>For å kunne publisere docker-images til registry i Harbor, må man ha opprettet
et prosjekt hvor disse kan ligge.</p><p>Et Harbor-prosjekt kan omfatte flere repoer, og det vil være naturlig at repoer
som naturlig henger sammen publiserer til samme prosjekt. Eksempelvis vil
Bestill bruke ett Harbor-prosjekt for alle sine repoer, NRL2 bruke et annet osv.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="opprette-nytt-prosjekt"></a>Opprette nytt prosjekt<a class="hash-link" href="#opprette-nytt-prosjekt" title="Direct link to heading">#</a></h2><p>Alle brukere kan opprette prosjekter i Harbor. Logg inn på
<a href="https://harbor.statkart.no" target="_blank" rel="noopener noreferrer">https://harbor.statkart.no</a> med standard AD-brukernavn/passord.</p><p>Velg &quot;New project&quot;.</p><p><img src="/assets/images/harbor_new_proj-6f4af3027e7dfb3c48633fdf36efd370.png"></p><p>Skriv inn et passende navn på prosjektet, svarer ofte til navnet på
GitLab-gruppen hvor repoet man publiserer fra ligger under (bestill, nrl2, gbok,
osv.)</p><p><img src="/assets/images/harbor_new_proj_dialog-d2b55921ebce383a4c0b500075e85f5c.png"></p><p>OBS! Huk av på &quot;Public&quot; under Access Level, slik at man kan pulle images fra repoet uten å måtte logge seg inn.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="opprette-robot-bruker-for-pushing-av-images-fra-gitlab"></a>Opprette robot-bruker for pushing av images fra GitLab<a class="hash-link" href="#opprette-robot-bruker-for-pushing-av-images-fra-gitlab" title="Direct link to heading">#</a></h2><p>For å publisere docker images fra GitLab-jobber trengs en robot-bruker, slik at man slipper å måtte autentisere seg med personlig bruker for slike operasjoner. Hvert prosjekt skal ha sin egen robot-bruker.</p><p>Klikk inn på prosjektet man ønsker å lage robot-bruker for. Velg &quot;Robot Accounts&quot;-fanen, og klikk på knappen &quot;New Robot Account&quot;. Gi roboten et kort, saklig navn, velg utløpstid i antall dager (eller &quot;Never&quot;).</p><p><img src="/assets/images/robotaccountsfane-06534e7cdda46e44eb7a5956baea1a17.png">
<img src="/assets/images/newrobotaccount-9a695621bd041cf694a45fe38ccb05bf.png"></p><p>Merk at det fulle navnet på roboten er en kombinasjon av &quot;robot$&quot;, pluss navnet på prosjektet, pluss navnet man skriver inn.</p><p>Klikk &quot;Add&quot;. I neste skjermbilde kommer navn og token opp. Klikk &quot;Export to file&quot; og lagre denne på et sikkert sted. Man kan ikke hente ut eller endre token&#x27;et til roboten i etterkant, dersom man har mistet det og trenger robot-bruker, må man opprette ny.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="bruk-av-proxy-cache"></a>Bruk av proxy cache<a class="hash-link" href="#bruk-av-proxy-cache" title="Direct link to heading">#</a></h2><p>Harbor kan også brukes som proxy cache på samme måte som vi har brukt Nexus tidligere, altså hente inn docker images utenfra gjennom Harbor istedenfor direkte fra GitHub. Dette muliggjør bl.a. sikkerhetsscanning av docker images utenfra også. Merk at per nå støttes det bare proxying av Docker Hub. Det kan ved behov legges til andre kilder også, men støtten for dette er meget begrenset (p.t. bare andre Harbor-registere).</p><p>Proxy cache brukes på samme måte som Nexus:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; docker pull harbor.statkart.no/proxy_cache/&lt;reponavn&gt;/&lt;imagenavn&gt;:&lt;tag&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Reponavn erstattes med library dersom man puller fra single-level repoer:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; docker pull harbor.statkart.no/proxy_cache/library/ubuntu:20.04</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><a href="https://goharbor.io/docs/2.1.0/administration/configure-proxy-cache/" target="_blank" rel="noopener noreferrer">https://goharbor.io/docs/2.1.0/administration/configure-proxy-cache/</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/kartverket/skip-docs/edit/main/docs/getting-started/harbor.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/getting-started/login-and-access-to-cluster"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Login og tilgang til cluster miljøer</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/getting-started/vault"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Oppsett og bruk av Vault »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#opprette-nytt-prosjekt" class="table-of-contents__link">Opprette nytt prosjekt</a></li><li><a href="#opprette-robot-bruker-for-pushing-av-images-fra-gitlab" class="table-of-contents__link">Opprette robot-bruker for pushing av images fra GitLab</a></li><li><a href="#bruk-av-proxy-cache" class="table-of-contents__link">Bruk av proxy cache</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Statens Kartverk</div></div></div></footer></div>
<script src="/assets/js/runtime~main.7f1dd57f.js"></script>
<script src="/assets/js/main.3de5be80.js"></script>
</body>
</html>